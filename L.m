clc;
clear all;
t1=0.005;
t2=0.005;
t3=0.005;
r1=0.028;
r2=0.014;
r3=0.005;
r4=0.045;
r5=0.05;
e1=210000000000;
e2=70000000000;
e3=13000000000;
p1=7890;
p2=2700;
p3=2900;
u1=0.3;
u2=0.33;
u3=0.33;
w=2*pi*20000;
c1=(e1/p1)^(1/2);
c3=(e2/p2)^(1/2);
c4=(e3/p3)^(1/2);
k3=w/c3;
k4=w/c4;
k1=w/c1;
G=e2/(2+2*u2);
k7=1.215854;% kτ
D=e2*(t1)^3/(12*(1-(u2)^2));
T=(t1^2)/12;
S=k7*D/(G*t1);
b0=(p1*t1*w^2/(G*t1))^(1/4);%δ0
bh=sqrt(2*(T*b0^4-1/S)/(1-u1));%δH
b1=sqrt((b0^4)/2*((T+S)+sqrt((T-S)^2+4/(b0)^4)));%δ1
b2=sqrt((b0^4)/2*((T+S)-sqrt((T-S)^2+4/(b0)^4)));%δ2
q1=b2^2/(T*b0^4-1/S);%σ1
q2=b1^2/(T*b0^4-1/S);%σ2

syms x
J1= besselj(0,x);%第一类贝塞尔函数 
J2=besselj(0,x);%第一类贝塞尔函数
J3=bessely(0,x);%第二类贝塞尔函数
J4=bessely(0,x);%第二类贝塞尔函数
diff_J1=diff(J1);
diff_J2=diff(J2);
diff_J3=diff(J3);
diff_J4=diff(J4);
y1 = subs(diff_J1,x,b1*r3);%第一类贝塞尔函数J′ 0(δ1,R3）
y2 = subs(diff_J2,x,b2*r3);%第一类贝塞尔函数J′ 0(δ2,R3）
y3 = subs(diff_J3,x,b1*r3);%第二类贝塞尔函数Y′ 0(δ1,R3）
y4 = subs(diff_J4,x,b2*r3);%第二类贝塞尔函数Y′ 0(δ2,R3）
y5 = subs(J1,x,b1*r3);%J0(δ1,R3)
y6 = subs(J2,x,b2*r3);%J0(δ2,R3)
y7 = subs(J3,x,b1*r3);%Y0(δ1,R3)
y8 = subs(J4,x,b2*r3);%Y0(δ1,R3)
y9 = subs(diff_J1,x,b1*r5);%第一类贝塞尔函数J′ 0(δ1,R5)
y10 = subs(diff_J2,x,b2*r5);%第一类贝塞尔函数J′ 0(δ2,R5)
y11 = subs(diff_J3,x,b1*r5);%第二类贝塞尔函数Y′ 0(δ1,R5)
y12 = subs(diff_J4,x,b2*r5);%第二类贝塞尔函数Y′ 0(δ2,R5)
y13 = subs(J1,x,b1*(r4+r5)/2);%J0(δ1,(r4+r5)/2)
y14 = subs(J2,x,b2*(r4+r5)/2);%J0(δ2,(r4+r5)/2)
y15 = subs(J3,x,b1*(r4+r5)/2);%Y0(δ1,(r4+r5)/2)
y16 = subs(J4,x,b2*(r4+r5)/2);%Y0(δ2,(r4+r5)/2)

syms L
o=(r1-r2)/(r1*L);%α
d11=o^2;
d12=o*k1;
d21=(r2^2-r3^2)*(k1*sin(k1*L)/(1/o-L)-cos(k1*L)/(L-1/o)^2)*e1*pi;
d22=(r2^2-r3^2)*e1*pi*(k1*cos(k1*L)/(L-1/o)-sin(k1*L)/(L-1/o)^2);
d23=-2*pi*r3*G*t1*q1*y1/k7;
d24=-2*pi*r3*G*t1*q2*y2/k7;
d25=-2*pi*r3*G*t1*q1*y3/k7;
d26=-2*pi*r3*G*t1*q2*y4/k7;
d31=cos(k1*L)/(L-1/o);
d32=sin(k1*L)/(L-1/o);
d33=-y5;
d34=-y6;
d35=-y7;
d36=-y8;
d43=(q1-1)*y1;
d44=(q2-1)*y2;
d45=(q1-1)*y3;
d46=(q2-1)*y4;
d53=d43;
d54=d44;
d55=d45;
d56=d46;
d63=-2*pi*r5*G*t1*q1*y9/k7;
d64=-2*pi*r5*G*t1*q2*y10/k7;
d65=-2*pi*r5*G*t1*q1*y11/k7;
d66=-2*pi*r5*G*t1*q2*y12/k7;
d68=(r5^2-r4^2)*pi*k3*e2;
d73=-y13;
d74=-y14;
d75=-y15;
d76=-y16;
d77=1;
d87=k3*e2*sin(k3*t2);
d88=-k3*e2*cos(k3*t2);
d810=k4*e3;
d97=cos(k3*t2);
d98=sin(k3*t2);
d99=-1;
d109=-k4*e3*sin(k4*t3);
d1010=k4*e3*cos(k4*t3);


a=[d11,d12,0,0,0,0,0,0,0,0;d21,d22,d23,d24,d25,d26,0,0,0,0;d31,d32,d33,d34,d35,d36,0,0,0,0;0,0,d43,d44,d45,46 ...
    0,0,0,0;0,0,d53,d54,d55,d56,0,0,0,0;0,0,d63,d64,d65,d66,0,d68,0,0;0,0,d73,d74,d75,d76,d77,0,0,0;0,0 ...
    0,0,0,0,d87,d88,0,d810;0,0,0,0,0,0,d97,d98,d99,0;0,0,0,0,0,0,0,0,d109,d1010];
fun=det(a);
L=solve(fun)